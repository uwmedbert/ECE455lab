<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cookbook &raquo; Runtime Tasking | Taskflow QuickStart</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://taskflow.github.io"><img src="taskflow_logo.png" alt="" />Taskflow</a> <span class="m-breadcrumb">|</span> <a href="index.html" class="m-thin">QuickStart</a>
      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Handbook</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="Cookbook.html">Cookbook</a> &raquo;</span>
          Runtime Tasking
        </h1>
        <nav class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li><a href="#CreateARuntimeTask">Create a Runtime Task</a></li>
            <li><a href="#CreateAsynchronousTasksFromARuntimeTask">Create Asynchronous Tasks from a Runtime Task</a></li>
            <li><a href="#SynchronizeWithCooperativeExecution">Synchronize with Cooperative Execution</a></li>
            <li><a href="#CreateRecursiveAsynchronousTasksFromARuntimeTask">Create Recursive Asynchronous Tasks from a Runtime Task</a></li>
          </ul>
        </nav>
<p>Taskflow allows tasks to interact with the scheduling runtime by taking a <em>runtime object</em> as an argument. This feature is particularly useful for implementing recursive parallel algorithms that create tasks dynamically.</p><section id="CreateARuntimeTask"><h2><a href="#CreateARuntimeTask">Create a Runtime Task</a></h2><p>A runtime task is a special type of task that interacts directly with the <a href="classtf_1_1Taskflow.html" class="m-doc">Taskflow</a> scheduling runtime through a <a href="classtf_1_1Runtime.html" class="m-doc">tf::<wbr />Runtime</a> object. By taking a <a href="classtf_1_1Runtime.html" class="m-doc">tf::<wbr />Runtime</a>&amp; parameter, a runtime task can dynamically create and manage other tasks during its execution. This capability enables flexible and expressive patterns such as recursive parallelism, cooperative task execution, and dynamic task spawning based on runtime conditions. For example, the code below creates a runtime task and acquires its running executor via <a href="classtf_1_1Runtime.html#a4ee48a82df1f9758a999d18e6015cec4" class="m-doc">tf::<wbr />Runtime::<wbr />executor()</a>:</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span>
<span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Runtime</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rt</span><span class="p">){</span><span class="w">  </span><span class="c1">// a runtime task</span>
<span class="w">  </span><span class="n">assert</span><span class="p">(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">rt</span><span class="p">.</span><span class="n">executor</span><span class="p">())</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">&amp;</span><span class="n">executor</span><span class="p">);</span>
<span class="p">});</span>
<span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span></pre></section><section id="CreateAsynchronousTasksFromARuntimeTask"><h2><a href="#CreateAsynchronousTasksFromARuntimeTask">Create Asynchronous Tasks from a Runtime Task</a></h2><p>Similar to <a href="classtf_1_1Executor.html" class="m-doc">tf::<wbr />Executor</a>, <a href="classtf_1_1Runtime.html" class="m-doc">tf::<wbr />Runtime</a> allows you to create asynchronous tasks using <a href="classtf_1_1Runtime.html#a5688b13034f179c4a8b2b0ebbb215051" class="m-doc">tf::<wbr />Runtime::<wbr />async</a> or <a href="classtf_1_1Runtime.html#a0ce29efa2106c8c5a1432e4a55ab2e05" class="m-doc">tf::<wbr />Runtime::<wbr />silent_async</a>. Asynchronous tasks spawned from a runtime task are logically parented to that runtime and are implicitly synchronized at the end of the runtime&#x27;s scope. For example, the code below creates a runtime task <code>A</code> that spawns 1,000 asynchronous tasks during its execution. These 1,000 asynchronous tasks will be implicitly joined before task <code>A</code> completes, ensuring that all of them finish before the runtime proceeds to task <code>B</code>.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="nf">executor</span><span class="p">(</span><span class="n">num_threads</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">atomic</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">counter</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Runtime</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rt</span><span class="p">){</span>
<span class="w">  </span><span class="c1">// spawn 1000 asynchronous tasks from this runtime task</span>
<span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">rt</span><span class="p">.</span><span class="n">silent_async</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">counter</span><span class="p">.</span><span class="n">fetch_add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">memory_order_relaxed</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// implicit synchronization at the end of the runtime scope</span>
<span class="p">});</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span>
<span class="w">  </span><span class="n">assert</span><span class="p">(</span><span class="n">counter</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="p">});</span>
<span class="n">A</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>
<span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span></pre><p>In addition to <a href="classtf_1_1Runtime.html#a5688b13034f179c4a8b2b0ebbb215051" class="m-doc">tf::<wbr />Runtime::<wbr />async</a> and <a href="classtf_1_1Runtime.html#a0ce29efa2106c8c5a1432e4a55ab2e05" class="m-doc">tf::<wbr />Runtime::<wbr />silent_async</a>, you can create a dynamic task graph from a <a href="classtf_1_1Runtime.html" class="m-doc">tf::<wbr />Runtime</a> using <a href="classtf_1_1Runtime.html#a42e87733508e3610d34728a38e975177" class="m-doc">tf::<wbr />Runtime::<wbr />dependent_async</a> and <a href="classtf_1_1Runtime.html#a1b89026b619e145c7e2c5c223a0adfc7" class="m-doc">tf::<wbr />Runtime::<wbr />silent_dependent_async</a>. For example, the code below creates a linear chain of dependent-async tasks from the execution context of a runtime:</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span>
<span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">counter</span><span class="o">=</span><span class="kt">int</span><span class="p">{</span><span class="mi">0</span><span class="p">}](</span><span class="n">tf</span><span class="o">::</span><span class="n">Runtime</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rt</span><span class="p">)</span><span class="w"> </span><span class="k">mutable</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">tf</span><span class="o">::</span><span class="n">AsyncTask</span><span class="w"> </span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rt</span><span class="p">.</span><span class="n">silent_dependent_async</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">counter</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="o">++</span><span class="n">counter</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="p">});</span>
<span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">tf</span><span class="o">::</span><span class="n">AsyncTask</span><span class="w"> </span><span class="n">curr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rt</span><span class="p">.</span><span class="n">silent_dependent_async</span><span class="p">([</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Runtime</span><span class="o">&amp;</span><span class="p">){</span><span class="w"> </span>
<span class="w">      </span><span class="n">assert</span><span class="p">(</span><span class="n">counter</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"> </span>
<span class="w">      </span><span class="o">++</span><span class="n">counter</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="n">prev</span><span class="p">);</span>
<span class="w">    </span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">curr</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span>
<span class="p">});</span><span class="w">  </span><span class="c1">// all dependent-async tasks will implicitly join at the runtime&#39;s end scope</span>
<span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span></pre></section><section id="SynchronizeWithCooperativeExecution"><h2><a href="#SynchronizeWithCooperativeExecution">Synchronize with Cooperative Execution</a></h2><p>The <a href="classtf_1_1Runtime.html#aba54a7cacffb54f5eb133730d256a7c4" class="m-doc">tf::<wbr />Runtime::<wbr />corun</a> method enables cooperative execution within a runtime task. It explicitly waits for all tasks spawned through the same <a href="classtf_1_1Runtime.html" class="m-doc">tf::<wbr />Runtime</a> object to complete before continuing execution. This is particularly useful when a runtime task launches multiple subtasks that must finish before the next phase of computation. Similar to <a href="classtf_1_1Executor.html#a8fcd9e0557922bb8194999f0cd433ea8" class="m-doc">tf::<wbr />Executor::<wbr />corun</a>, the calling worker does not block; instead, it continues to execute available tasks from the executor, cooperating with other workers through the work-stealing loop.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="nf">executor</span><span class="p">(</span><span class="n">num_threads</span><span class="p">);</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">atomic</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">counter</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Runtime</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rt</span><span class="p">){</span>
<span class="w">  </span><span class="c1">// spawn 1000 asynchronous tasks from this runtime task</span>
<span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">rt</span><span class="p">.</span><span class="n">silent_async</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">counter</span><span class="p">.</span><span class="n">fetch_add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">memory_order_relaxed</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// explicitly synchronize all asynchronous tasks without blocking the calling worker</span>
<span class="w">  </span><span class="n">rt</span><span class="p">.</span><span class="n">corun</span><span class="p">();</span>
<span class="w">  </span><span class="n">assert</span><span class="p">(</span><span class="n">counter</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// spawn another 1000 asynchronous tasks from this runtime task</span>
<span class="w">  </span><span class="k">for</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">rt</span><span class="p">.</span><span class="n">silent_async</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">counter</span><span class="p">.</span><span class="n">fetch_add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">memory_order_relaxed</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// implicit synchronization at the end of the runtime scope</span>
<span class="p">});</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span>
<span class="w">  </span><span class="n">assert</span><span class="p">(</span><span class="n">counter</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2000</span><span class="p">);</span>
<span class="p">});</span>
<span class="n">A</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>
<span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span></pre><p>In this example, all 100 asynchronous tasks spawned by the runtime are guaranteed to complete before the call to corun returns. This cooperative execution model is especially useful for expressing multi-phase or hierarchical parallel algorithms that require intermediate synchronization within a single runtime task.</p></section><section id="CreateRecursiveAsynchronousTasksFromARuntimeTask"><h2><a href="#CreateRecursiveAsynchronousTasksFromARuntimeTask">Create Recursive Asynchronous Tasks from a Runtime Task</a></h2><p>Each asynchronous task can itself be a runtime task, enabling recursive task creation and dynamic parallelism. This model is particularly powerful for implementing divide-and-conquer algorithms, such as parallel sort, graph traversal, and recursion. For instance, the example below demonstrates a parallel recursive implementation of Fibonacci numbers using recursive asynchronous tasking with <a href="classtf_1_1Runtime.html" class="m-doc">tf::<wbr />Runtime</a>:</p><pre class="m-code"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;taskflow/taskflow.hpp&gt;</span>

<span class="kt">size_t</span><span class="w"> </span><span class="nf">fibonacci</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Runtime</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">N</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span>

<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">res1</span><span class="p">,</span><span class="w"> </span><span class="n">res2</span><span class="p">;</span>
<span class="w">  </span><span class="n">rt</span><span class="p">.</span><span class="n">silent_async</span><span class="p">([</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">res1</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Runtime</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rt1</span><span class="p">){</span><span class="w"> </span><span class="n">res1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fibonacci</span><span class="p">(</span><span class="n">N</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">rt1</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1">// tail optimization for the right child</span>
<span class="w">  </span><span class="n">res2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fibonacci</span><span class="p">(</span><span class="n">N</span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="n">rt</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// use corun to avoid blocking the worker from waiting children tasks to finish</span>
<span class="w">  </span><span class="n">rt</span><span class="p">.</span><span class="n">corun</span><span class="p">();</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">res1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">res2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="w">  </span>
<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="w">  </span><span class="n">executor</span><span class="p">.</span><span class="n">silent_async</span><span class="p">([</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">res</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Runtime</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rt</span><span class="p">){</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fibonacci</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">rt</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="n">executor</span><span class="p">.</span><span class="n">wait_for_all</span><span class="p">();</span>

<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;-th Fibonacci number is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></pre><p>The figure below shows the execution diagram, where the task with suffix <code>*_1</code> represents the left child spawned by its parent runtime.</p><div class="m-graph"><svg style="width: 40.400rem; height: 26.000rem;" viewBox="0.00 0.00 404.00 260.00">
<g transform="scale(1 1) rotate(0) translate(4 256)">
<title>Fibonacci</title>
<g class="m-node m-flat">
<title>F4</title>
<polygon points="258,-252 184,-252 184,-216 258,-216 258,-252"/>
<text text-anchor="middle" x="221" y="-237" font-family="Helvetica,sans-Serif" font-size="10.00">fibonacci(4)</text>
<text text-anchor="middle" x="221" y="-226" font-family="Helvetica,sans-Serif" font-size="10.00">[rt]</text>
</g>
<g class="m-node m-flat">
<title>F3_1</title>
<polygon points="212,-180 138,-180 138,-144 212,-144 212,-180"/>
<text text-anchor="middle" x="175" y="-165" font-family="Helvetica,sans-Serif" font-size="10.00">fibonacci(3)</text>
<text text-anchor="middle" x="175" y="-154" font-family="Helvetica,sans-Serif" font-size="10.00">[rt1]</text>
</g>
<g class="m-edge">
<title>F4&#45;&gt;F3_1</title>
<path d="M209.63,-215.7C204.28,-207.56 197.8,-197.69 191.89,-188.7"/>
<polygon points="194.66,-186.54 186.24,-180.1 188.81,-190.38 194.66,-186.54"/>
</g>
<g class="m-node m-flat">
<title>F2_2</title>
<polygon points="304,-180 230,-180 230,-144 304,-144 304,-180"/>
<text text-anchor="middle" x="267" y="-165" font-family="Helvetica,sans-Serif" font-size="10.00">fibonacci(2)</text>
<text text-anchor="middle" x="267" y="-154" font-family="Helvetica,sans-Serif" font-size="10.00">[rt]</text>
</g>
<g class="m-edge">
<title>F4&#45;&gt;F2_2</title>
<path d="M232.37,-215.7C237.72,-207.56 244.2,-197.69 250.11,-188.7"/>
<polygon points="253.19,-190.38 255.76,-180.1 247.34,-186.54 253.19,-190.38"/>
</g>
<g class="m-node m-flat">
<title>F2_1</title>
<polygon points="120,-108 46,-108 46,-72 120,-72 120,-108"/>
<text text-anchor="middle" x="83" y="-93" font-family="Helvetica,sans-Serif" font-size="10.00">fibonacci(2)</text>
<text text-anchor="middle" x="83" y="-82" font-family="Helvetica,sans-Serif" font-size="10.00">[rt1_1]</text>
</g>
<g class="m-edge">
<title>F3_1&#45;&gt;F2_1</title>
<path d="M152.26,-143.7C140.56,-134.8 126.14,-123.82 113.49,-114.2"/>
<polygon points="115.56,-111.37 105.48,-108.1 111.32,-116.94 115.56,-111.37"/>
</g>
<g class="m-node m-flat">
<title>F1_2</title>
<polygon points="212,-108 138,-108 138,-72 212,-72 212,-108"/>
<text text-anchor="middle" x="175" y="-93" font-family="Helvetica,sans-Serif" font-size="10.00">fibonacci(1)</text>
<text text-anchor="middle" x="175" y="-82" font-family="Helvetica,sans-Serif" font-size="10.00">[rt1]</text>
</g>
<g class="m-edge">
<title>F3_1&#45;&gt;F1_2</title>
<path d="M175,-143.7C175,-135.98 175,-126.71 175,-118.11"/>
<polygon points="178.5,-118.1 175,-108.1 171.5,-118.1 178.5,-118.1"/>
</g>
<g class="m-node m-flat">
<title>F1_1</title>
<polygon points="74,-36 0,-36 0,0 74,0 74,-36"/>
<text text-anchor="middle" x="37" y="-21" font-family="Helvetica,sans-Serif" font-size="10.00">fibonacci(1)</text>
<text text-anchor="middle" x="37" y="-10" font-family="Helvetica,sans-Serif" font-size="10.00">[rt1_1_1]</text>
</g>
<g class="m-edge">
<title>F2_1&#45;&gt;F1_1</title>
<path d="M71.63,-71.7C66.28,-63.56 59.8,-53.69 53.89,-44.7"/>
<polygon points="56.66,-42.54 48.24,-36.1 50.81,-46.38 56.66,-42.54"/>
</g>
<g class="m-node m-flat">
<title>F0_1</title>
<polygon points="166,-36 92,-36 92,0 166,0 166,-36"/>
<text text-anchor="middle" x="129" y="-21" font-family="Helvetica,sans-Serif" font-size="10.00">fibonacci(0)</text>
<text text-anchor="middle" x="129" y="-10" font-family="Helvetica,sans-Serif" font-size="10.00">[rt1_1]</text>
</g>
<g class="m-edge">
<title>F2_1&#45;&gt;F0_1</title>
<path d="M94.37,-71.7C99.72,-63.56 106.2,-53.69 112.11,-44.7"/>
<polygon points="115.19,-46.38 117.76,-36.1 109.34,-42.54 115.19,-46.38"/>
</g>
<g class="m-node m-flat">
<title>F1_3</title>
<polygon points="304,-108 230,-108 230,-72 304,-72 304,-108"/>
<text text-anchor="middle" x="267" y="-93" font-family="Helvetica,sans-Serif" font-size="10.00">fibonacci(1)</text>
<text text-anchor="middle" x="267" y="-82" font-family="Helvetica,sans-Serif" font-size="10.00">[rt1]</text>
</g>
<g class="m-edge">
<title>F2_2&#45;&gt;F1_3</title>
<path d="M267,-143.7C267,-135.98 267,-126.71 267,-118.11"/>
<polygon points="270.5,-118.1 267,-108.1 263.5,-118.1 270.5,-118.1"/>
</g>
<g class="m-node m-flat">
<title>F0_2</title>
<polygon points="396,-108 322,-108 322,-72 396,-72 396,-108"/>
<text text-anchor="middle" x="359" y="-93" font-family="Helvetica,sans-Serif" font-size="10.00">fibonacci(0)</text>
<text text-anchor="middle" x="359" y="-82" font-family="Helvetica,sans-Serif" font-size="10.00">[rt]</text>
</g>
<g class="m-edge">
<title>F2_2&#45;&gt;F0_2</title>
<path d="M289.74,-143.7C301.44,-134.8 315.86,-123.82 328.51,-114.2"/>
<polygon points="330.68,-116.94 336.52,-108.1 326.44,-111.37 330.68,-116.94"/>
</g>
</g>
</svg>
</div><p>For more details, please refer to <a href="AsyncTasking.html" class="m-doc">Asynchronous Tasking</a> and <a href="fibonacci.html" class="m-doc">Fibonacci Number</a>.</p></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v2.js"></script>
<script src="searchdata-v2.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Taskflow handbook is part of the <a href="https://taskflow.github.io">Taskflow project</a>, copyright © <a href="https://tsung-wei-huang.github.io/">Dr. Tsung-Wei Huang</a>, 2018&ndash;2025.<br />Generated by <a href="https://doxygen.org/">Doxygen</a> 1.9.1 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
